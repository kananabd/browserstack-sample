const a89_0x15fb6c=a89_0x36b9;function a89_0x37da(){const _0x383979=['assign','data','Percy\x20is\x20not\x20supported\x20for\x20','getConfig','./constants.js','Testhub\x20started\x20with\x20id:\x20','error','includes','BS_TESTOPS_BUILD_COMPLETED','percy','status','POST','lssBT','authToken','success','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','checkAndSetupPercy','2115228rrdTKd','152307pxFwvf','KaPXb','5278007CofASh','setTestHubCommonMetaInfo','uploadPending','env','finished_metadata','api/v1/builds/','setTestObservabilityVariables','config','isAccessibilityEnabled','12377416bGVbkC','BROWSERSTACK_CENTRAL_SCANNER_JOBID','resolve','auth','true','35576vsAqiw','OBSERVABILITY','allowScreenshot','BROWSERSTACK_TESTHUB_UUID','getProductMap','central_scanner','ACCESSIBILITY','../helper','STOP','settings','HcDAT','push','path','../performance/constants','getInstance','buildIdentifier','BROWSERSTACK_TEST_OBSERVABILITY','zUQTe','basename','ptjgD','BROWSERSTACK_TESTHUB_JWT','stop','17229200nAhnxe','projectName','../../bin/utils/constants.js','waitForBuildStatus','getFrameworkDetails','kHFTY','PERCY_SUPPORTED_FRAMEWORKS','measureWrapper','HqZHT','exports','../test-observability/requestQueueHandler.js','false','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','./utils.js','FqcYZ','ENV_VAR','MAjRp','OuaCd','statusText','isUndefined','winstonLogger','job_id','buildDescription','dLYDb','BROWSERSTACK_PRODUCT_MAP','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','getUserName','token','../test-observability/sessionHandler.js','8pnCyas','Kexqy','toISOString','accessibilityOptions','BROWSERSTACK_CENTRAL_USER','CANge','jwt','isBrowserstackInfra','getAccessibilityOptions','generateBuildUpstreamData','../test-observability/utils','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','framework','9KBTckY','user_killed','Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','stringify','JsgOa','48Zeoowc','logBuildError','getHostInfo','response','buildName','pTyON','bHtHJ','null','debug','getGitMetaData','JJoJq','BROWSERSTACK_ACCESSIBILITY','message','crMPS','buildStopSent','QbYDZ','launchBuild','PUT','extractDataFromResponse','2738965LzPGjK','/stop'];a89_0x37da=function(){return _0x383979;};return a89_0x37da();}(function(_0x3f77e7,_0x4f0739){const _0x63d192=a89_0x36b9,_0x3edc4c=_0x3f77e7();while(!![]){try{const _0x3df342=parseInt(_0x63d192(0xef))/0x1+parseInt(_0x63d192(0x83))/0x2*(parseInt(_0x63d192(0xc8))/0x3)+parseInt(_0x63d192(0xb6))/0x4*(parseInt(_0x63d192(0xdb))/0x5)+parseInt(_0x63d192(0xee))/0x6+-parseInt(_0x63d192(0x75))/0x7+-parseInt(_0x63d192(0x7e))/0x8*(-parseInt(_0x63d192(0xc3))/0x9)+-parseInt(_0x63d192(0x99))/0xa;if(_0x3df342===_0x4f0739)break;else _0x3edc4c['push'](_0x3edc4c['shift']());}catch(_0x30abe0){_0x3edc4c['push'](_0x3edc4c['shift']());}}}(a89_0x37da,0xe939f));const bsSetupHelper=require(a89_0x15fb6c(0x8a)),path=require(a89_0x15fb6c(0x8f)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a89_0x15fb6c(0xc0)),testhubUtils=require(a89_0x15fb6c(0xa6)),testHubConstants=require(a89_0x15fb6c(0xe1)),constants=require(a89_0x15fb6c(0x9b)),RequestQueueHandler=require(a89_0x15fb6c(0xa3)),logger=require('../logger')[a89_0x15fb6c(0xad)],SessionHandler=require(a89_0x15fb6c(0xb5)),PerformanceTester=require('../performance/performance-tester.js'),{TESTHUB_EVENTS:PerformanceEvents}=require(a89_0x15fb6c(0x90));class TestHubHandler{static [a89_0x15fb6c(0xd6)]=![];static async[a89_0x15fb6c(0xd8)](_0x3bb304,_0x68f2c5){const _0x1816f9=a89_0x15fb6c,_0x29e251={'ptjgD':function(_0x6b7e5f,_0x94e012){return _0x6b7e5f||_0x94e012;},'FqcYZ':function(_0x1de813,_0x39a278){return _0x1de813===_0x39a278;},'MAjRp':function(_0x3f04ac){return _0x3f04ac();},'JJoJq':_0x1816f9(0xa5),'xFHVX':'false','bHtHJ':_0x1816f9(0xec),'Kemcv':function(_0x153ec7,_0xf8e46b,_0x16bd25,_0x34c4be,_0x47d415){return _0x153ec7(_0xf8e46b,_0x16bd25,_0x34c4be,_0x47d415);},'CANge':_0x1816f9(0xe8),'HqZHT':function(_0xe8c337,_0x2c3a55){return _0xe8c337===_0x2c3a55;}};await PerformanceTester[_0x1816f9(0xa0)](PerformanceEvents['START'],async()=>{const _0x161bb9=_0x1816f9,_0x484c90=Object[_0x161bb9(0xdd)]({},_0x68f2c5[_0x161bb9(0x7c)],{'root_dir_path':'','framework':_0x68f2c5[_0x161bb9(0xc2)]}),_0x193922=bsSetupHelper[_0x161bb9(0xb3)](_0x484c90),_0x181607=bsSetupHelper['getAccessKey'](_0x484c90),_0x5b0882=_0x29e251['ptjgD'](_0x193922,'')+':'+_0x29e251[_0x161bb9(0x96)](_0x181607,''),_0x3cfb48=testhubUtils['getProductMap'](_0x484c90);process['env'][_0x161bb9(0xb1)]=JSON['stringify'](_0x3cfb48);if(_0x29e251[_0x161bb9(0xa7)](_0x5b0882,':'))return _0x29e251[_0x161bb9(0xa9)](isTestObservabilitySession)&&(logger[_0x161bb9(0xd0)](_0x29e251[_0x161bb9(0xd2)]),process[_0x161bb9(0x78)][_0x161bb9(0xe5)]=_0x29e251['xFHVX']),testhubUtils['isAccessibilityEnabled'](_0x484c90)&&logger['debug'](_0x29e251[_0x161bb9(0xce)]),[null,null];try{const _0x59dc95=await this[_0x161bb9(0xbf)](_0x484c90,_0x3bb304),_0x4c1c67=this[_0x161bb9(0xe0)](_0x193922,_0x181607),_0x486515=await _0x29e251['Kemcv'](nodeRequest,_0x29e251[_0x161bb9(0xbb)],testHubConstants['TESTHUB_BUILD_API'],_0x59dc95,_0x4c1c67);await this['checkAndSetupPercy'](_0x68f2c5,_0x3bb304);const _0x4294ba=this['extractDataFromResponse'](_0x484c90,_0x486515,_0x4c1c67);return _0x4294ba;}catch(_0x5f4901){if(_0x29e251[_0x161bb9(0xa1)](_0x5f4901[_0x161bb9(0xeb)],![])){testhubUtils[_0x161bb9(0xc9)](_0x5f4901);return;}}})();}static async[a89_0x15fb6c(0xed)](_0x517957,_0x419c9a){const _0x3efae6=a89_0x15fb6c;if(constants[_0x3efae6(0x9f)][_0x3efae6(0xe4)](_0x419c9a)){await _0x517957['setupPercy']();return;}_0x517957['config'][_0x3efae6(0xe6)]&&logger[_0x3efae6(0xd0)](_0x3efae6(0xdf)+_0x419c9a+'\x20framework');}static[a89_0x15fb6c(0xbe)](_0x113c63){const _0x2da106=a89_0x15fb6c,_0x15ea09={};_0x15ea09[_0x2da106(0x8c)]=_0x113c63[_0x2da106(0xb9)];const _0x9f6330=_0x15ea09;return _0x9f6330;}static['getConfig'](_0x3b48d4,_0x334993){const _0x347826=a89_0x15fb6c,_0x56d61c={'JsgOa':function(_0x58573d,_0x559bdd){return _0x58573d(_0x559bdd);}},_0x3e842f={};return _0x3e842f['username']=_0x3b48d4,_0x3e842f['password']=_0x334993,{'auth':_0x3e842f,'headers':_0x56d61c[_0x347826(0xc7)](getDefaultHeaders,![])};}static async['generateBuildUpstreamData'](_0x371943,_0x1b1e64){const _0x460642=a89_0x15fb6c,_0x871ddd={'dLYDb':function(_0x4ef9f5,_0x2d5613){return _0x4ef9f5(_0x2d5613);}},_0xf8b103={'project_name':_0x371943[_0x460642(0x9a)]||'','name':_0x371943[_0x460642(0xcc)]||path[_0x460642(0x95)](path[_0x460642(0x80)](process['cwd']())),'build_identifier':_0x371943[_0x460642(0x92)],'description':_0x371943[_0x460642(0xaf)]||'','started_at':new Date()[_0x460642(0xb8)](),'tags':_0x871ddd[_0x460642(0xb0)](getCustomTags,_0x371943),'host_info':bsSetupHelper[_0x460642(0xca)](),'ci_info':bsSetupHelper['getCiInfo'](),'build_run_identifier':process[_0x460642(0x78)]['BROWSERSTACK_BUILD_RUN_IDENTIFIER'],'failed_tests_rerun':process['env']['BROWSERSTACK_RERUN']||![],'version_control':await bsSetupHelper[_0x460642(0xd1)](),'accessibility':this[_0x460642(0xbe)](_0x371943),'framework_details':testhubUtils[_0x460642(0x9d)](_0x371943,_0x1b1e64),'product_map':testhubUtils[_0x460642(0x87)](_0x371943),'browserstackAutomation':bsSetupHelper[_0x460642(0xbd)]()};if(process[_0x460642(0x78)][_0x460642(0xba)]){const _0x259060={};_0x259060[_0x460642(0xae)]=process['env'][_0x460642(0x7f)],_0x259060[_0x460642(0xb4)]=process[_0x460642(0x78)]['BROWSERSTACK_CENTRAL_SCANNER_JWT'],_0xf8b103[_0x460642(0x88)]=_0x259060;}return _0xf8b103;}static[a89_0x15fb6c(0xda)](_0x26ed1c,_0x167c8f,_0x2cb9eb){const _0x12611e=a89_0x15fb6c,_0x3dfdbb={'QbYDZ':function(_0x22ec5f){return _0x22ec5f();},'KaPXb':function(_0x192bdb,_0x5f26ea){return _0x192bdb&&_0x5f26ea;},'zUQTe':_0x12611e(0x82),'crMPS':_0x12611e(0xa4)},_0x7bbeea={};if(_0x3dfdbb[_0x12611e(0xd7)](isTestObservabilitySession)){const [_0x5e2061,_0x195b48,_0x389235]=testhubUtils[_0x12611e(0x7b)](_0x167c8f[_0x12611e(0xde)],_0x2cb9eb[_0x12611e(0x81)]);if(_0x3dfdbb['KaPXb'](_0x5e2061,_0x195b48)){const _0x3d805a={};_0x3d805a[_0x12611e(0xbc)]=_0x5e2061,_0x3d805a['buildHashedId']=_0x195b48,_0x3d805a[_0x12611e(0x85)]=_0x389235,_0x7bbeea[testHubConstants[_0x12611e(0x84)]]=_0x3d805a,process[_0x12611e(0x78)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x3dfdbb['zUQTe'];}else _0x7bbeea[testHubConstants[_0x12611e(0x84)]]={},process[_0x12611e(0x78)][_0x12611e(0x93)]=_0x3dfdbb[_0x12611e(0xd5)];}else process[_0x12611e(0x78)][_0x12611e(0x93)]=_0x3dfdbb[_0x12611e(0xd5)];if(testhubUtils[_0x12611e(0x7d)](_0x26ed1c)){const [_0x5b2060,_0x38fb45]=testhubUtils['setAccessibilityVariables'](_0x167c8f[_0x12611e(0xde)]);if(_0x3dfdbb[_0x12611e(0x74)](_0x5b2060,_0x38fb45)){const _0x21ce04={};_0x21ce04[_0x12611e(0xea)]=_0x5b2060,_0x21ce04['buildHashedId']=_0x38fb45,_0x7bbeea[testHubConstants[_0x12611e(0x89)]]=_0x21ce04,process[_0x12611e(0x78)]['BROWSERSTACK_ACCESSIBILITY']=_0x3dfdbb[_0x12611e(0x94)];}else _0x7bbeea[testHubConstants[_0x12611e(0x89)]]={},process['env']['BROWSERSTACK_ACCESSIBILITY']=_0x3dfdbb['crMPS'];}else process[_0x12611e(0x78)][_0x12611e(0xd3)]=_0x3dfdbb[_0x12611e(0xd5)];return testhubUtils[_0x12611e(0x76)](_0x167c8f[_0x12611e(0xde)]),logger['info'](_0x12611e(0xe2)+process[_0x12611e(0x78)][_0x12611e(0x86)]),_0x7bbeea;}static async[a89_0x15fb6c(0x98)](_0x114edd){const _0x1f29ff=a89_0x15fb6c,_0x5933b9={'gOjAr':function(_0x4db2f8,_0x508c08){return _0x4db2f8===_0x508c08;},'Kexqy':_0x1f29ff(0xa4),'OuaCd':function(_0x25120c,_0x34d266){return _0x25120c===_0x34d266;},'lHeIc':_0x1f29ff(0xcf),'lssBT':function(_0x2d74,_0x4c05db){return _0x2d74===_0x4c05db;},'qzhpR':_0x1f29ff(0xb2),'pTyON':_0x1f29ff(0xe3),'jeDAT':_0x1f29ff(0xc5),'SMXKi':_0x1f29ff(0x79),'sFyaY':_0x1f29ff(0xc4),'vwXyG':function(_0x4502da){return _0x4502da();},'HcDAT':function(_0x572706,_0x3df3d7,_0x3ee2f6,_0x17fad9,_0x2a03e9,_0x57e46a){return _0x572706(_0x3df3d7,_0x3ee2f6,_0x17fad9,_0x2a03e9,_0x57e46a);},'phSVn':_0x1f29ff(0xd9),'kHFTY':'stopBuildUpstream\x20event\x20successful!','FEZxD':_0x1f29ff(0xeb)};await PerformanceTester[_0x1f29ff(0xa0)](PerformanceEvents[_0x1f29ff(0x8b)],async()=>{const _0x50002b=_0x1f29ff;if(_0x5933b9['gOjAr'](process[_0x50002b(0x78)][_0x50002b(0xe5)],_0x5933b9[_0x50002b(0xb7)])||TestHubHandler[_0x50002b(0xd6)]||bsSetupHelper[_0x50002b(0xac)](process['env'][testHubConstants[_0x50002b(0xa8)]['BROWSERSTACK_TESTHUB_JWT']]))return;TestHubHandler[_0x50002b(0xd6)]=!![],await RequestQueueHandler[_0x50002b(0x91)]()[_0x50002b(0x77)](),await SessionHandler[_0x50002b(0x9c)]();if(_0x5933b9[_0x50002b(0xaa)](process['env'][testHubConstants['ENV_VAR'][_0x50002b(0x97)]],_0x5933b9['lHeIc'])||_0x5933b9[_0x50002b(0xe9)](process[_0x50002b(0x78)][testHubConstants[_0x50002b(0xa8)]['BROWSERSTACK_TESTHUB_UUID']],_0x5933b9['lHeIc'])){logger['debug'](_0x5933b9['qzhpR']);const _0x549312={};return _0x549312[_0x50002b(0xe7)]=_0x5933b9['pTyON'],_0x549312[_0x50002b(0xd4)]=_0x5933b9['jeDAT'],_0x549312;}const _0x247c30={'finished_at':new Date()[_0x50002b(0xb8)](),'finished_metadata':[]};!!_0x114edd&&_0x247c30[_0x5933b9['SMXKi']][_0x50002b(0x8e)]({'reason':_0x5933b9['sFyaY'],'signal':_0x114edd,'failure_data':''});const _0x5e0633={'headers':_0x5933b9['vwXyG'](getDefaultHeaders)};try{const _0x2c3e90=await _0x5933b9[_0x50002b(0x8d)](nodeRequest,_0x5933b9['phSVn'],_0x50002b(0x7a)+process[_0x50002b(0x78)][testHubConstants['ENV_VAR'][_0x50002b(0x86)]]+_0x50002b(0xdc),_0x247c30,_0x5e0633,![]);if(_0x2c3e90[_0x50002b(0xde)]&&_0x2c3e90[_0x50002b(0xde)][_0x50002b(0xe3)]){const _0x39887b={};_0x39887b[_0x50002b(0xd4)]=_0x2c3e90['data'][_0x50002b(0xe3)];throw _0x39887b;}else{logger[_0x50002b(0xd0)](_0x5933b9[_0x50002b(0x9e)]);const _0x273e7b={};return _0x273e7b[_0x50002b(0xe7)]=_0x5933b9['FEZxD'],_0x273e7b[_0x50002b(0xd4)]='',_0x273e7b;}}catch(_0x1e14a3){_0x1e14a3['response']?logger[_0x50002b(0xd0)](_0x50002b(0xc1)+_0x1e14a3[_0x50002b(0xcb)][_0x50002b(0xe7)]+'\x20'+_0x1e14a3[_0x50002b(0xcb)][_0x50002b(0xab)]+'\x20'+JSON[_0x50002b(0xc6)](_0x1e14a3[_0x50002b(0xcb)][_0x50002b(0xde)])):logger[_0x50002b(0xd0)]('EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20'+(_0x1e14a3[_0x50002b(0xd4)]||_0x1e14a3));const _0x5b6a80={};return _0x5b6a80[_0x50002b(0xe7)]=_0x5933b9[_0x50002b(0xcd)],_0x5b6a80[_0x50002b(0xd4)]=_0x1e14a3[_0x50002b(0xd4)]||_0x1e14a3['response']?_0x1e14a3[_0x50002b(0xcb)][_0x50002b(0xe7)]+':'+_0x1e14a3[_0x50002b(0xcb)][_0x50002b(0xab)]:_0x1e14a3,_0x5b6a80;}})();}}function a89_0x36b9(_0x218c31,_0x67d034){const _0x37da78=a89_0x37da();return a89_0x36b9=function(_0x36b9d0,_0x5c195c){_0x36b9d0=_0x36b9d0-0x74;let _0x501857=_0x37da78[_0x36b9d0];return _0x501857;},a89_0x36b9(_0x218c31,_0x67d034);}module[a89_0x15fb6c(0xa2)]=TestHubHandler;