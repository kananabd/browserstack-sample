"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InvalidateAPIGatewayInstanceCache = void 0;
const apigatewayservice_1 = require("../service/apigatewayservice");
const apiGatewayService = new apigatewayservice_1.ApiGatewayService();
function InvalidateAPIGatewayInstanceCache() {
    return (target, key, descriptor) => {
        const fn = descriptor.value;
        descriptor.value = async function (...args) {
            const instance = args[0];
            await fn.apply(this, args);
            await apiGatewayService.invalidateCacheByKey("systeminstancebyguid", instance.instanceId);
            await apiGatewayService.invalidateCacheByKey("systeminstancebyurl", instance.getEndpointUrl());
        };
    };
}
exports.InvalidateAPIGatewayInstanceCache = InvalidateAPIGatewayInstanceCache;
