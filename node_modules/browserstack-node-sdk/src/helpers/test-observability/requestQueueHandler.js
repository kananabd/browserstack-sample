const a85_0x1ee286=a85_0xfd45;function a85_0xfd45(_0x3314d5,_0x3775f1){const _0x4f57ef=a85_0x4f57();return a85_0xfd45=function(_0xfd45d,_0xa7db7d){_0xfd45d=_0xfd45d-0x133;let _0xa36c15=_0x4f57ef[_0xfd45d];return _0xa36c15;},a85_0xfd45(_0x3314d5,_0x3775f1);}(function(_0x1c5a0b,_0x139efb){const _0x4e42d2=a85_0xfd45,_0x548ae7=_0x1c5a0b();while(!![]){try{const _0x4b902b=parseInt(_0x4e42d2(0x155))/0x1*(-parseInt(_0x4e42d2(0x162))/0x2)+-parseInt(_0x4e42d2(0x197))/0x3+-parseInt(_0x4e42d2(0x168))/0x4+-parseInt(_0x4e42d2(0x184))/0x5*(parseInt(_0x4e42d2(0x14f))/0x6)+-parseInt(_0x4e42d2(0x195))/0x7+parseInt(_0x4e42d2(0x18a))/0x8+parseInt(_0x4e42d2(0x151))/0x9;if(_0x4b902b===_0x139efb)break;else _0x548ae7['push'](_0x548ae7['shift']());}catch(_0x3b8f28){_0x548ae7['push'](_0x548ae7['shift']());}}}(a85_0x4f57,0xcf55b));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require(a85_0x1ee286(0x17a)),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a85_0x1ee286(0x193)),{nestedKeyValue}=require(a85_0x1ee286(0x141)),util=require('util');function a85_0x4f57(){const _0xc9bfed=['vJLGE','add','BATCH_EVENT_TYPES','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','queue','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','FwZbF','data','api/v1/batch','1486ZLMylc','statusText','CBTSessionCreated','shouldProceed','test_run','pendingUploads','2572124hPFFqM','batchAndPostEvents','ghrHi','format','error','uOuVI','byteLength','SEFep','instance','loQnr','response','miqcp','slice','TEST_SCREENSHOT','max','emNXq','TestRunStarted','status','./constants','Processing\x20events.\x20Queue\x20Length\x20-\x20','1|4|0|2|5|3','start','XZHKh','dcFEc','FipFM','EjSAp','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','eventUrl','10AHiFaN','proceedWithData','uploadPending','join','event_type','removeEventBatchPolling','2665392NTWTYm','mXPuy','ZuwgK','pPnBu','LzKDh','riTdx','started','length','HookRunStarted','./utils','pollEventBatchInterval','379113XGlUiS','ahHJX','4513716qVhFiH','svzTy','TestRunSkipped','\x20bytes.\x20Events\x20are\x20','TanUd','OfjXo','proceedWithUrl','REMOVING','\x20event\x20successful\x20for\x20events\x20','LfgJY','hook_run','push','XxTHP','fRSOz','.\x20Request\x20Size\x20-\x20','screenshotEventUrl','HLkJF','startEventBatchPolling','../helper','WzsGH','RESETTING','splice','uuid','elgMM','resetEventBatchPolling','EXCEPTION\x20IN\x20','mgwgi','shutdown','\x20--\x20','JeAPD','HookRunFinished','JAHrc','4497258GAIXpL','message','39202722ZzSQTL','POST','logs','mEtgz','187SGygko','diYDv','kind','gARvw'];a85_0x4f57=function(){return _0xc9bfed;};return a85_0x4f57();}class RequestQueueHandler{static [a85_0x1ee286(0x170)];[a85_0x1ee286(0x167)]=0x0;constructor(){const _0x3abcbe=a85_0x1ee286,_0x270c0c={};_0x270c0c[_0x3abcbe(0x18f)]=_0x3abcbe(0x17c),_0x270c0c[_0x3abcbe(0x171)]=_0x3abcbe(0x161),_0x270c0c[_0x3abcbe(0x158)]='api/v1/screenshots',_0x270c0c[_0x3abcbe(0x13b)]='LogCreated',_0x270c0c[_0x3abcbe(0x13c)]=_0x3abcbe(0x164),_0x270c0c[_0x3abcbe(0x134)]='TestRunFinished',_0x270c0c[_0x3abcbe(0x15f)]=_0x3abcbe(0x199),_0x270c0c[_0x3abcbe(0x13f)]=_0x3abcbe(0x14d),_0x270c0c['WzsGH']=_0x3abcbe(0x178),_0x270c0c[_0x3abcbe(0x18e)]=_0x3abcbe(0x192);const _0x32d804=_0x270c0c,_0x139218=_0x32d804[_0x3abcbe(0x18f)]['split']('|');let _0x10e33e=0x0;while(!![]){switch(_0x139218[_0x10e33e++]){case'0':this['eventUrl']=_0x32d804[_0x3abcbe(0x171)];continue;case'1':this[_0x3abcbe(0x15d)]=[];continue;case'2':this['screenshotEventUrl']=_0x32d804['gARvw'];continue;case'3':this['pollEventBatchInterval']=null;continue;case'4':this[_0x3abcbe(0x190)]=![];continue;case'5':this[_0x3abcbe(0x15b)]=[_0x32d804[_0x3abcbe(0x13b)],_0x32d804[_0x3abcbe(0x13c)],_0x32d804[_0x3abcbe(0x134)],_0x32d804['FwZbF'],_0x32d804[_0x3abcbe(0x13f)],_0x32d804[_0x3abcbe(0x142)],_0x32d804[_0x3abcbe(0x18e)]];continue;}break;}}static['getInstance'](){const _0x13f985=a85_0x1ee286;return!RequestQueueHandler['instance']&&(RequestQueueHandler[_0x13f985(0x170)]=new RequestQueueHandler()),RequestQueueHandler['instance'];}[a85_0x1ee286(0x17d)]=()=>{const _0x1bb60b=a85_0x1ee286;!this[_0x1bb60b(0x190)]&&(this['started']=!![],this[_0x1bb60b(0x140)]());};[a85_0x1ee286(0x15a)]=_0x4d21ab=>{const _0x388b62=a85_0x1ee286,_0x22bb41={'ghrHi':function(_0x136fd0,_0x25e950){return _0x136fd0===_0x25e950;},'dcFEc':_0x388b62(0x175),'JeAPD':function(_0xdce6ac,_0x4bcfda){return _0xdce6ac(_0x4bcfda);},'rpnmq':_0x388b62(0x15c)};if(this[_0x388b62(0x15b)]['includes'](_0x4d21ab['event_type'])){if(_0x4d21ab['logs']&&_0x4d21ab[_0x388b62(0x153)][0x0]&&_0x22bb41[_0x388b62(0x16a)](_0x4d21ab['logs'][0x0][_0x388b62(0x157)],_0x22bb41[_0x388b62(0x17f)])){const _0x17957b={};return _0x17957b[_0x388b62(0x165)]=!![],_0x17957b[_0x388b62(0x185)]=[_0x4d21ab],_0x17957b[_0x388b62(0x135)]=this[_0x388b62(0x13e)],_0x17957b;}this['queue'][_0x388b62(0x13a)](_0x4d21ab);let _0x352bc4=null;const _0x8304b5=this[_0x388b62(0x165)]();_0x8304b5&&(_0x22bb41[_0x388b62(0x14c)](trace,_0x22bb41['rpnmq']),_0x352bc4=this['queue'][_0x388b62(0x174)](0x0,BATCH_SIZE),this[_0x388b62(0x15d)][_0x388b62(0x144)](0x0,BATCH_SIZE),this['resetEventBatchPolling']());const _0x24b6f5={};return _0x24b6f5[_0x388b62(0x165)]=_0x8304b5,_0x24b6f5['proceedWithData']=_0x352bc4,_0x24b6f5[_0x388b62(0x135)]=this[_0x388b62(0x183)],_0x24b6f5;}const _0x238ff8={};return _0x238ff8['shouldProceed']=!![],_0x238ff8;};[a85_0x1ee286(0x14a)]=async()=>{const _0x2ac12b=a85_0x1ee286,_0x380bc5={'diYDv':'REMOVING','mEtgz':function(_0x550d6a,_0x102020){return _0x550d6a>_0x102020;},'FipFM':'Shutdown-Queue','pPnBu':function(_0x4d8195,_0xc69037){return _0x4d8195(_0xc69037);}};await this[_0x2ac12b(0x186)](),this['removeEventBatchPolling'](_0x380bc5[_0x2ac12b(0x156)]);while(_0x380bc5[_0x2ac12b(0x154)](this[_0x2ac12b(0x15d)]['length'],0x0)){const _0x4ef6f3=this[_0x2ac12b(0x15d)][_0x2ac12b(0x174)](0x0,BATCH_SIZE);this[_0x2ac12b(0x15d)][_0x2ac12b(0x144)](0x0,BATCH_SIZE),await this[_0x2ac12b(0x169)](this[_0x2ac12b(0x183)],_0x380bc5[_0x2ac12b(0x180)],_0x4ef6f3);}_0x380bc5['mEtgz'](this[_0x2ac12b(0x167)],0x0)&&_0x380bc5[_0x2ac12b(0x18d)](debug,'Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20'+this[_0x2ac12b(0x167)]);};[a85_0x1ee286(0x169)]=async(_0x27cb75,_0x518a66,_0x17a18b)=>{const _0x4f307a=a85_0x1ee286,_0x3901ce={'JAHrc':function(_0x1ba4a8,_0x47da3b){return _0x1ba4a8(_0x47da3b);},'LfgJY':'utf8','elgMM':function(_0x5919c2){return _0x5919c2();},'mgwgi':function(_0x2b483e,_0x3f63b9,_0x253f3d,_0x2b0261,_0x5d7904){return _0x2b483e(_0x3f63b9,_0x253f3d,_0x2b0261,_0x5d7904);},'uSSqh':_0x4f307a(0x152),'miqcp':function(_0x7154c7,_0x506620){return _0x7154c7-_0x506620;},'izbND':function(_0x3c46e6,_0x1acc4f){return _0x3c46e6(_0x1acc4f);},'uOuVI':function(_0x5c7101,_0x4cc8fc){return _0x5c7101(_0x4cc8fc);}};let _0x25b04d='';try{_0x25b04d=_0x17a18b['map'](_0xefda42=>'\x27'+_0xefda42[_0x4f307a(0x188)]+'\x27:'+(nestedKeyValue(_0xefda42,[_0x4f307a(0x166),_0x4f307a(0x145)])||nestedKeyValue(_0xefda42,[_0x4f307a(0x139),_0x4f307a(0x145)])))[_0x4f307a(0x187)](','),_0x3901ce['JAHrc'](debug,'Processing\x20batch\x20events\x20for\x20'+_0x518a66+_0x4f307a(0x13d)+Buffer[_0x4f307a(0x16e)](util['format']('%j',_0x17a18b),_0x3901ce[_0x4f307a(0x138)])+_0x4f307a(0x19a)+_0x25b04d);}catch(_0x15e190){_0x3901ce[_0x4f307a(0x14e)](debug,_0x4f307a(0x182)+util[_0x4f307a(0x16b)](_0x15e190)+'}');}const _0x12df87={'headers':_0x3901ce[_0x4f307a(0x146)](getDefaultHeaders)};try{const _0x238e4f=await _0x3901ce[_0x4f307a(0x149)](nodeRequest,_0x3901ce['uSSqh'],_0x27cb75,_0x17a18b,_0x12df87);if(_0x238e4f[_0x4f307a(0x160)][_0x4f307a(0x16c)]){const _0x4bc927={};_0x4bc927[_0x4f307a(0x150)]=_0x238e4f[_0x4f307a(0x160)][_0x4f307a(0x16c)];throw _0x4bc927;}else _0x3901ce['JAHrc'](debug,_0x518a66+_0x4f307a(0x137)+_0x25b04d+_0x4f307a(0x14b)+util['format']('%j',_0x238e4f[_0x4f307a(0x160)])),this[_0x4f307a(0x167)]=Math[_0x4f307a(0x176)](0x0,_0x3901ce['miqcp'](this['pendingUploads'],_0x17a18b['length']));}catch(_0x255f2a){_0x255f2a[_0x4f307a(0x172)]?_0x3901ce['izbND'](debug,_0x4f307a(0x148)+_0x518a66+_0x4f307a(0x15e)+_0x255f2a[_0x4f307a(0x172)][_0x4f307a(0x179)]+'\x20'+_0x255f2a[_0x4f307a(0x172)][_0x4f307a(0x163)]+'\x20'+util['format']('%j',_0x255f2a[_0x4f307a(0x172)])):_0x3901ce[_0x4f307a(0x16d)](debug,_0x4f307a(0x148)+_0x518a66+_0x4f307a(0x15e)+(_0x255f2a['message']||_0x255f2a)),this[_0x4f307a(0x167)]=Math['max'](0x0,_0x3901ce[_0x4f307a(0x173)](this['pendingUploads'],_0x17a18b[_0x4f307a(0x191)]));}};[a85_0x1ee286(0x140)]=()=>{const _0x4e0340=a85_0x1ee286,_0x286591={'emNXq':function(_0x3a6da,_0x4e1629){return _0x3a6da>_0x4e1629;},'vJLGE':function(_0x1d670c,_0x5eada6){return _0x1d670c(_0x5eada6);},'mXPuy':'Interval-Queue','SEFep':function(_0x452231,_0x111a17,_0x51099e){return _0x452231(_0x111a17,_0x51099e);}};this[_0x4e0340(0x194)]=_0x286591[_0x4e0340(0x16f)](setInterval,async()=>{const _0x3b4d02=_0x4e0340;if(_0x286591[_0x3b4d02(0x177)](this[_0x3b4d02(0x15d)]['length'],0x0)){_0x286591[_0x3b4d02(0x159)](trace,_0x3b4d02(0x17b)+this[_0x3b4d02(0x15d)][_0x3b4d02(0x191)]);const _0x2bdbf1=this[_0x3b4d02(0x15d)][_0x3b4d02(0x174)](0x0,BATCH_SIZE);this['queue'][_0x3b4d02(0x144)](0x0,BATCH_SIZE),await this[_0x3b4d02(0x169)](this[_0x3b4d02(0x183)],_0x286591[_0x3b4d02(0x18b)],_0x2bdbf1),_0x286591[_0x3b4d02(0x159)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this[_0x3b4d02(0x15d)]['length']);}},BATCH_INTERVAL);};[a85_0x1ee286(0x147)]=()=>{const _0x6f8e2f=a85_0x1ee286,_0x46604c={};_0x46604c[_0x6f8e2f(0x18c)]=_0x6f8e2f(0x143);const _0x586983=_0x46604c;this[_0x6f8e2f(0x189)](_0x586983['ZuwgK']),this[_0x6f8e2f(0x140)]();};[a85_0x1ee286(0x189)]=_0x1c6a90=>{const _0x2055f0=a85_0x1ee286,_0x3c04af={'TanUd':function(_0x50b5b4,_0x4180f4){return _0x50b5b4(_0x4180f4);},'XZHKh':function(_0x4f2dc6,_0x438bf8){return _0x4f2dc6===_0x438bf8;},'KtjVz':_0x2055f0(0x136)};this[_0x2055f0(0x194)]&&(_0x3c04af[_0x2055f0(0x133)](clearInterval,this[_0x2055f0(0x194)]),this[_0x2055f0(0x194)]=null,_0x3c04af[_0x2055f0(0x17e)](_0x1c6a90,_0x3c04af['KtjVz'])&&(this['started']=![]));};['shouldProceed']=()=>{const _0x5c60f5=a85_0x1ee286,_0x28ddde={};_0x28ddde[_0x5c60f5(0x181)]=function(_0x330fe0,_0x5a53cf){return _0x330fe0>=_0x5a53cf;};const _0x43e343=_0x28ddde;return _0x43e343[_0x5c60f5(0x181)](this[_0x5c60f5(0x15d)]['length'],BATCH_SIZE);};async['uploadPending'](_0x142868=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x1e689c=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x5d28d2=a85_0x1ee286,_0x18579f={'ahHJX':function(_0x4d1b46,_0x16933b){return _0x4d1b46<=_0x16933b;},'svzTy':function(_0x58cf69,_0x123c4c){return _0x58cf69(_0x123c4c);},'BLfEH':function(_0x1a3527,_0x2cce02){return _0x1a3527-_0x2cce02;}};if(_0x18579f[_0x5d28d2(0x196)](this[_0x5d28d2(0x167)],0x0)||_0x18579f[_0x5d28d2(0x196)](_0x142868,0x0))return;return await _0x18579f[_0x5d28d2(0x198)](sleep,_0x1e689c),this[_0x5d28d2(0x186)](_0x18579f['BLfEH'](_0x142868,_0x1e689c));}}module['exports']=RequestQueueHandler;